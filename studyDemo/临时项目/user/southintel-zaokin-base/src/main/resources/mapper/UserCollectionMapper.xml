<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.southintel.zaokin.base.mapper.UserCollectionMapper">
    <select id="selectOne" parameterType="com.southintel.zaokin.base.entity.UserCollection" resultType="java.lang.Integer">
        select count(1) from user_collection where user_id=#{userId} and article_id=#{policyId}
    </select>
    <insert id="insertOne" parameterType="com.southintel.zaokin.base.entity.UserCollection">
        <selectKey resultType="java.lang.Integer" keyProperty="id" order="AFTER">
            SELECT LAST_INSERT_ID()
        </selectKey>
        insert into user_collection (user_id,article_id,title,publish_department,publish_time)
        values (#{userId},#{policyId},#{title},#{publishDepartment},#{publishTime})
    </insert>

    <select id="selectOneCreatime" resultType="java.lang.String">
        select create_time from user_collection where id=#{id}
    </select>

    <!-- in -->
    <delete id="deletes" parameterType="java.util.Arrays">
        delete from user_collection where user_id=#{user_id} and article_id in
        <foreach collection="params" index="index" item="item"
                 open="(" separator="," close=")">
            #{item}
        </foreach>

    </delete>

    <select id="getUserCollection" resultType="java.util.Map">
        select article_id as 'policyId',title as 'title',publish_department as 'publishDepartment',publish_time as 'publishTime',date_format(create_time,'%Y-%m-%d %T') as 'date' from user_collection
        where  user_id=#{params.userId}
       order by create_time desc limit #{params.startIndex},#{params.pageSize}
    </select>

    <select id="getUserCollectionTotal" resultType="java.lang.Integer">
        select count(1) from  user_collection where user_id=#{userId}
    </select>

    <select id="getUserCollectionById" resultType="java.lang.Integer">
        select count(1) from user_collection where user_id = #{userId} and article_id =#{policyId}
    </select>
</mapper>